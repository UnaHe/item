{{partial("layout/header")}}
{{stylesheet_link("leaflet/leaflet.css")}}
{{stylesheet_link("leaflet/L.Icon.Pulse.css")}}
<section id="content_wrapper">
    <div id="topbar">
        <div class="topbar-left">
            <ol class="breadcrumb">
                <li class="crumb-active"><a href="#">{{"CoachList"|_}}</a></li>
                <li class="crumb-icon"><a href="/{{routerProjectId}}/index/index"><span class="glyphicon glyphicon-home"></span></a></li>
                <li class="crumb-link"><a href="/{{routerProjectId}}/index/index">{{"Home"|_}}</a></li>
                <li class="crumb-trail">{{"CoachList"|_}}</li>
            </ol>
        </div>
    </div>
    <div id="content">
        <div class="row">
            <div class="col-md-12">
                <div class="panel">
                    <div class="panel-heading">
                        <span class="panel-title">
                            <span class="glyphicons glyphicons-group"></span> {{"CoachList"|_}} </span>
                        <div class="topbar-right" style="margin-right: 10px;">
                    </div>
                    </div>
                    <div class="panel-body pbn">
                        <table class="table table-striped table-bordered table-hover" id="datatable">
                            <thead>
                            <th style="width:1%">照片</th>
                            <th nowrap="">姓名</th>
                            <th nowrap="">性别</th>
                            <th nowrap="">年龄</th>
                            <th nowrap="">驾龄</th>
                            <th nowrap="">评分</th>
                            <th nowrap="">座右铭</th>
                            <th style="width:120px" nowrap="">评价次数</th>
                            <th style="width:1%" class="hidden-xs">操作</th>
                            </thead>
                            <tbody>

                            {%for i in coachList%}
                            <tr id="doctor_{{i['coach_id']}}">
                                <td nowrap="">{%if i['coach_photo'] is defined%}<img src="{{i['coach_photo']}}" width="50"/>{%else%}<img src="/client/crash.png "/>{%endif%}</td>
                                <td class="text-left">{{i['coach_name']}}</td>
                                <td class="text-left">{%if i['coach_gender']==1%}男{%elseif i['coach_gender']==2%}女{%endif%}</td>
                                <td class="text-left">{{i['coach_age']}}</td>
                                <td class="text-left">{{i['coach_seniority']}}</td>
                                <td nowrap="">{{i['coach_score']}}</td>
                                <td class="text-left">{{i['coach_intro']}}</td>
                                <td nowrap>{{i['evaluate_count']}}次</td>
                                <td nowrap>
                                    <button type="button" class="btn btn-default btn-gradient btn-xs" onclick="$('.btn').attr('disabled','disabled');location.href ='/{{routerProjectId}}/coach/coachhandle?coach_id={{i['coach_id']}}';" style="margin-left: 10px">{{"Edit"|_}}</button>
                                    <button type="button" class="btn btn-default btn-gradient btn-xs deleteBtn" data-id="{{i['coach_id']}}" style="margin-left: 10px">{{"Delete"|_}}</button>
                                </td>
                            </tr>
                            {%endfor%}
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>

{{partial ("layout/footer")}}
{{javascript_include('client/vendor/plugins/multiselect/bootstrap-multiselect.js')}}
{{javascript_include('client/vendor/plugins/datatables/js/jquery.dataTables.min.js')}}
{{javascript_include('client/vendor/plugins/datatables/js/datatables.js')}}
{{javascript_include('client/vendor/plugins/datatables/extras/TableTools/media/js/TableTools.min.js')}}
{{javascript_include('client/vendor/plugins/datatables/extras/TableTools/media/js/ZeroClipboard.js')}}
{{javascript_include('client/js/main.js')}}
<script type="text/javascript">
    function deleteCoach(id){
        $('.btn').attr('disabled','disabled');
        $.ajax('/{{routerProjectId}}/coach/coachdelete', {
            data: {
                coach_id:id,
            },
            type: 'post',
            dataType: 'json',
            success: function(data)
            {
                if (data.errcode == 0)
                {
                    $('#doctor_'+id).remove()
                }else{
                    alert(data.errmsg);
                }
            },
            error: function()
            {
                alert('服务器错误');
            },
            complete:function(){
                $('.btn').removeAttr('disabled');
            }
        });
    }
    jQuery(document).ready(function () {
        "use strict";
        // Init Theme Core
        Core.init();

        $('.deleteBtn').each(function(){
            $(this).on('click',function(){
                if (confirm("确定要删除此教练？")){
                    $(this).parent().append('{{image("oss/Images/Icons/Load/load-7.gif" , 'width':'20')}}');
                    deleteCoach($(this).attr('data-id'))
                }
            });
        })
        $('#datatable').dataTable({
            "aoColumnDefs": [{ 'bSortable': false, 'aTargets': [ -1 , 0 , 1,2 ] }],
            "oLanguage": { "oPaginate": {"sPrevious": "", "sNext": ""} },
            "iDisplayLength": 10,
            "aLengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
            "sDom": '<"panel-menu dt-panelmenu"lfr><"clearfix">tip',
        });
        $('.dataTables_filter input').attr("placeholder", "搜索");

    });

</script>

</body>
</html>
