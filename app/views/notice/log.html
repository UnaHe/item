{% extends "layout/main.html" %}

{% block content %}

    <script type="text/javascript" src="/client/pagers.js"></script>
    <div class="tpl-content-page-title am-icon-share-square">
        {{"NoticeLog"|_}}
    </div>
    <ol class="am-breadcrumb">
        <li><a href="/" class="am-icon-home homePage">首页</a></li>
        <li>{{"NoticeManage"|_}}</li>
        <li class="am-active"><a href="/notice/log" >{{"NoticeLog"|_}}</a></li>
    </ol>
    <div class="tpl-portlet-components">
        <div class="row">
            <div class="am-g">
                <div class="am-u-sm-12">
                    <form class="am-form">
                        <table class="am-table am-table-striped am-table-hover am-table-compact" style="font-size: 12px;">
                            <thead>
                            <tr>
                                <th style="width: 8%">{{'NoticeLevel'|_}}</th>
                                <th style="min-width: 30%">{{'ContentCN'|_}}</th>
                                <th style="width: 8%">{{'ContentEN'|_}}</th>
                                <th style="width: 10%">推送人</th>
                                <th style="width: 12%">推送时间</th>
                                <th style="width: 8%">操作</th>
                            </tr>
                            </thead>
                            <tbody>
                            {%for i in noticeList%}
                            <tr>
                                <td>{%if i['notice_level']==1%}紧急信息{%elseif i['notice_level']==3%}临时信息{%endif%}</td>
                                <td>{{i['notice_content_zh_CN']}} </td>
                                <td>{{i['notice_content_en_US']}} </td>
                                <td>{{i['client_realname']}} ( {{i['client_name']}} )</td>
                                <td>{{date("Y-m-d H:i",i['notice_created_at'])}}</td>
                                <td>
                                    <button type="button" class="btn am-btn am-btn-warning am-btn-xs am-radius editBtn" data-id="{{i['notice_id']}}">{{"PushAgain"|_}}</button>
                                </td>
                            </tr>
                            {%endfor%}
                            </tbody>
                        </table>
                    </form>
                    <div class="am-u-lg-12">
                        <div class="am-cf">
                            <div class="am-fr">
                                <script language="JavaScript">
                                    var pg = new showPages('pg');pg.pageCount = {{pageCount}};pg.printHtml();
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        jQuery(document).ready(function () {
            "use strict";
            $('.editBtn').bind('click',function(){
                var id = $(this).attr('data-id');
                $('.btn').attr('disabled','disabled');
                var l = Ladda.create(document.querySelector('.editBtn'));
                l.start();
                location.href='/notice/push?notice_id='+id;
            })
        });
    </script>

{% endblock %}